
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>thunder.ThunderContext</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.1.0/simplex/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0.RC3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="None" href="../index.html" />
    <link rel="up" title="API Reference" href="../api.html" />
    <link rel="next" title="thunder.Series" href="thunder.Series.html" />
    <link rel="prev" title="thunder.Colorize" href="thunder.Colorize.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><img src="../_static/thunder_logo.png">
           </a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.0.RC3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="../tutorials.html">Tutorials</a></li>
                <li><a href="../api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction to Thunder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_local.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_ec2.html">Running on EC2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../style_guide.html">Style guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">F.A.Q.</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/freeman-lab/thunder/releases">Release notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/basic_usage.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/thunder_context.html">Thunder context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/input_formats.html">Input formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/images.html">Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/series.html">Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multi_index.html">Multi-indexing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/factorization.html">Factorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/regression.html">Regression</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://gitter.im/thunder-project/thunder">Gitter chatroom</a></li>
<li class="toctree-l1"><a class="reference external" href="https://groups.google.com/forum/?hl=en#!forum/thunder-user">Mailing list</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/freeman-lab/thunder">Github repo</a></li>
<li class="toctree-l1"><a class="reference external" href="http://thefreemanlab.com/thunder/">Project page</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">thunder</span></tt>.ThunderContext</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="thunder-thundercontext">
<h1><tt class="xref py py-mod docutils literal"><span class="pre">thunder</span></tt>.ThunderContext<a class="headerlink" href="#thunder-thundercontext" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="thunder.ThunderContext">
<em class="property">class </em><tt class="descclassname">thunder.</tt><tt class="descname">ThunderContext</tt><big>(</big><em>sparkcontext</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for a SparkContext that provides an entry point for loading and saving.</p>
<p>Also supports creation of example datasets, and loading example
data both locally and from EC2.</p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><cite>_sc</cite></td>
<td>(SparkContext) Spark context for Spark functionality</td>
</tr>
<tr class="row-even"><td><cite>_credentials</cite></td>
<td>(AWSCredentials object, optional, default = None) Stores public and private keys for AWS services. Typically available through configuration files, and but can optionally be set using <a class="reference internal" href="#thunder.ThunderContext.setAWSCredentials" title="thunder.ThunderContext.setAWSCredentials"><tt class="xref py py-func docutils literal"><span class="pre">ThunderContext.setAWSCredentials()</span></tt></a>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">__init__</span></tt>(sparkcontext)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#thunder.ThunderContext.convertImagesToSeries" title="thunder.ThunderContext.convertImagesToSeries"><tt class="xref py py-obj docutils literal"><span class="pre">convertImagesToSeries</span></tt></a>(dataPath,&nbsp;outputDirPath)</td>
<td>Write out Images data as Series data, saved in a flat binary format.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#thunder.ThunderContext.export" title="thunder.ThunderContext.export"><tt class="xref py py-obj docutils literal"><span class="pre">export</span></tt></a>(data,&nbsp;filename[,&nbsp;outputFormat,&nbsp;...])</td>
<td>Export local array data to a variety of formats.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#thunder.ThunderContext.loadExample" title="thunder.ThunderContext.loadExample"><tt class="xref py py-obj docutils literal"><span class="pre">loadExample</span></tt></a>([dataset])</td>
<td>Load a local example data set for testing analyses.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#thunder.ThunderContext.loadExampleS3" title="thunder.ThunderContext.loadExampleS3"><tt class="xref py py-obj docutils literal"><span class="pre">loadExampleS3</span></tt></a>([dataset])</td>
<td>Load an example data set from S3.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#thunder.ThunderContext.loadImages" title="thunder.ThunderContext.loadImages"><tt class="xref py py-obj docutils literal"><span class="pre">loadImages</span></tt></a>(dataPath[,&nbsp;dims,&nbsp;dtype,&nbsp;...])</td>
<td>Loads an Images object from data stored as a binary image stack, tif, or png files.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#thunder.ThunderContext.loadImagesAsSeries" title="thunder.ThunderContext.loadImagesAsSeries"><tt class="xref py py-obj docutils literal"><span class="pre">loadImagesAsSeries</span></tt></a>(dataPath[,&nbsp;dims,&nbsp;...])</td>
<td>Load Images data as Series data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#thunder.ThunderContext.loadImagesOCP" title="thunder.ThunderContext.loadImagesOCP"><tt class="xref py py-obj docutils literal"><span class="pre">loadImagesOCP</span></tt></a>(bucketName,&nbsp;resolution[,&nbsp;...])</td>
<td>Load Images from OCP (Open Connectome Project).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#thunder.ThunderContext.loadParams" title="thunder.ThunderContext.loadParams"><tt class="xref py py-obj docutils literal"><span class="pre">loadParams</span></tt></a>(path)</td>
<td>Load a file with parameters from a local file system or S3.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#thunder.ThunderContext.loadSeries" title="thunder.ThunderContext.loadSeries"><tt class="xref py py-obj docutils literal"><span class="pre">loadSeries</span></tt></a>(dataPath[,&nbsp;nkeys,&nbsp;nvalues,&nbsp;...])</td>
<td>Loads a Series object from data stored as binary, text, npy, or mat.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#thunder.ThunderContext.makeExample" title="thunder.ThunderContext.makeExample"><tt class="xref py py-obj docutils literal"><span class="pre">makeExample</span></tt></a>(dataset,&nbsp;**opts)</td>
<td>Make an example data set for testing analyses.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#thunder.ThunderContext.setAWSCredentials" title="thunder.ThunderContext.setAWSCredentials"><tt class="xref py py-obj docutils literal"><span class="pre">setAWSCredentials</span></tt></a>(awsAccessKeyId,&nbsp;...)</td>
<td>Manually set AWS access credentials to be used by Thunder.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#thunder.ThunderContext.start" title="thunder.ThunderContext.start"><tt class="xref py py-obj docutils literal"><span class="pre">start</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Starts a ThunderContext using the same arguments as SparkContext</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="thunder.ThunderContext.convertImagesToSeries">
<tt class="descname">convertImagesToSeries</tt><big>(</big><em>dataPath</em>, <em>outputDirPath</em>, <em>dims=None</em>, <em>inputFormat='stack'</em>, <em>ext=None</em>, <em>dtype='int16'</em>, <em>blockSize='150M'</em>, <em>blockSizeUnits='pixels'</em>, <em>startIdx=None</em>, <em>stopIdx=None</em>, <em>shuffle=True</em>, <em>overwrite=False</em>, <em>recursive=False</em>, <em>nplanes=None</em>, <em>npartitions=None</em>, <em>renumber=False</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.convertImagesToSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out Images data as Series data, saved in a flat binary format.</p>
<p>The resulting files may subsequently be read in using ThunderContext.loadSeries().
Loading Series data directly will likely be faster than converting image data
to a Series object through loadImagesAsSeries().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataPath: string</strong></p>
<blockquote>
<div><p>Path to data files or directory, as either a local filesystem path or a URI.
May include a single &#8216;*&#8217; wildcard in the filename. Examples of valid dataPaths include
&#8216;local/directory/<a href="#id1"><span class="problematic" id="id2">*</span></a>.stack&#8221;, &#8220;s3n:///my-s3-bucket/data/&#8221;, or &#8220;file:///mnt/another/directory/&#8221;.</p>
</div></blockquote>
<p><strong>outputDirPath: string</strong></p>
<blockquote>
<div><p>Path to directory to write Series file output. May be either a path on the local file system
or a URI-like format, such as &#8220;local/directory&#8221;, &#8220;s3n:///my-s3-bucket/data/&#8221;,
or &#8220;file:///mnt/another/directory/&#8221;. If the directory exists and &#8216;overwrite&#8217; is True,
the existing directory and all its contents will be deleted and overwritten.</p>
</div></blockquote>
<p><strong>dims: tuple of positive int, optional (required if inputFormat is &#8216;stack&#8217;)</strong></p>
<blockquote>
<div><p>Image dimensions. Binary stack data will be interpreted as a multidimensional array
with the given dimensions, and should be stored in row-major order (Fortran or Matlab convention),
where the first dimension changes most rapidly. For &#8216;png&#8217; or &#8216;tif&#8217; data dimensions
will be read from the image file headers.</p>
</div></blockquote>
<p><strong>inputFormat: str, optional, default = &#8216;stack&#8217;</strong></p>
<blockquote>
<div><p>Expected format of the input data: &#8216;stack&#8217;, &#8216;png&#8217;, or &#8216;tif&#8217;. &#8216;stack&#8217; indicates flat binary stacks.
&#8216;png&#8217; or &#8216;tif&#8217; indicate image formats. Page of a multipage tif file will be extend along
the third dimension. Separate files interpreted as distinct records, with ordering
given by lexicographic sorting of file names.</p>
</div></blockquote>
<p><strong>ext: string, optional, default = None</strong></p>
<blockquote>
<div><p>File extension, default will be &#8220;bin&#8221; if inputFormat==&#8221;stack&#8221;, &#8220;tif&#8221; for inputFormat==&#8217;tif&#8217;,
and &#8216;png&#8217; for inputFormat==&#8221;png&#8221;.</p>
</div></blockquote>
<p><strong>dtype: string or numpy dtype. optional, default &#8216;int16&#8217;</strong></p>
<blockquote>
<div><p>Data type of the image files to be loaded, specified as a numpy &#8220;dtype&#8221; string.
Ignored for &#8216;tif&#8217; or &#8216;png&#8217; (data will be inferred from image formats).</p>
</div></blockquote>
<p><strong>blockSize: string or positive int, optional, default &#8220;150M&#8221;</strong></p>
<blockquote>
<div><p>Requested size of blocks (e.g &#8220;64M&#8221;, &#8220;512k&#8221;, &#8220;2G&#8221;). If shuffle=True, can also be a
tuple of int specifying the number of pixels or splits per dimension. Indirectly
controls the number of Spark partitions, with one partition per block.</p>
</div></blockquote>
<p><strong>blockSizeUnits: string, either &#8220;pixels&#8221; or &#8220;splits&#8221;, default &#8220;pixels&#8221;</strong></p>
<blockquote>
<div><p>Units for interpreting a tuple passed as blockSize when shuffle=True.</p>
</div></blockquote>
<p><strong>startIdx: nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>Convenience parameters to read only a subset of input files. Uses python slice conventions
(zero-based indexing with exclusive final position). These parameters give the starting
and final index after lexicographic sorting.</p>
</div></blockquote>
<p><strong>stopIdx: nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>See startIdx.</p>
</div></blockquote>
<p><strong>shuffle: boolean, optional, default = True</strong></p>
<blockquote>
<div><p>Controls whether the conversion from Images to Series formats will use of a Spark shuffle-based method.</p>
</div></blockquote>
<p><strong>overwrite: boolean, optional, default False</strong></p>
<blockquote>
<div><p>If true, the directory specified by outputDirPath will be deleted (recursively) if it
already exists. (Use with caution.)</p>
</div></blockquote>
<p><strong>recursive: boolean, optional, default = False</strong></p>
<blockquote>
<div><p>If true, will recursively descend directories rooted at dataPath, loading all files
in the tree with an appropriate extension.</p>
</div></blockquote>
<p><strong>nplanes: positive integer, optional, default = None</strong></p>
<blockquote>
<div><p>Subdivide individual image files. Every <cite>nplanes</cite> from each file will be considered a new record.
With nplanes=None (the default), a single file will be considered as representing a single record.
If the number of records per file is not the same across all files, then <cite>renumber</cite> should be set
to True to ensure consistent keys.</p>
</div></blockquote>
<p><strong>npartitions: positive int, optional, default = None</strong></p>
<blockquote>
<div><p>Specify number of partitions for the RDD, if unspecified will use 1 partition per image.</p>
</div></blockquote>
<p><strong>renumber: boolean, optional, default = False</strong></p>
<blockquote class="last">
<div><p>Recalculate keys for records after images are loading. Only necessary if different files contain
different number of records (e.g. due to specifying nplanes). See Images.renumber().</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.export">
<tt class="descname">export</tt><big>(</big><em>data</em>, <em>filename</em>, <em>outputFormat=None</em>, <em>overwrite=False</em>, <em>varname=None</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Export local array data to a variety of formats.</p>
<p>Can write to a local file sytem or S3 (destination inferred from filename schema).
S3 writing useful for persisting arrays when working in an environment without
accessible local storage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array-like</p>
<blockquote>
<div><p>The data to export</p>
</div></blockquote>
<p><strong>filename</strong> : str</p>
<blockquote>
<div><p>Output location (path/to/file.ext)</p>
</div></blockquote>
<p><strong>outputFormat</strong> : str, optional, default = None</p>
<blockquote>
<div><p>Ouput format (&#8220;npy&#8221;, &#8220;mat&#8221;, or &#8220;txt&#8221;), if not provided will
try to infer from file extension.</p>
</div></blockquote>
<p><strong>overwrite</strong> : boolean, optional, default = False</p>
<blockquote>
<div><p>Whether to overwrite if directory or file already exists</p>
</div></blockquote>
<p><strong>varname</strong> : str, optional, default = None</p>
<blockquote class="last">
<div><p>Variable name for writing &#8220;mat&#8221; formatted files</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.loadExample">
<tt class="descname">loadExample</tt><big>(</big><em>dataset=None</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.loadExample" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a local example data set for testing analyses.</p>
<p>Some of these data sets are extremely downsampled and should be considered
useful only for testing the API. If called with None,
will return list of available datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataset</strong> : str</p>
<blockquote>
<div><p>Which dataset to load</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong> : Data object</p>
<blockquote class="last">
<div><p>Generated dataset as a Thunder data objects (e.g Series or Images)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.loadExampleS3">
<tt class="descname">loadExampleS3</tt><big>(</big><em>dataset=None</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.loadExampleS3" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an example data set from S3.</p>
<p>Info on the included datasets can be found at the CodeNeuro data repository
(<a class="reference external" href="http://datasets.codeneuro.org/">http://datasets.codeneuro.org/</a>). If called with None, will return
list of available datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataset</strong> : str</p>
<blockquote>
<div><p>Which dataset to load</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong> : a Data object (usually a Series or Images)</p>
<blockquote>
<div><p>The dataset as one of Thunder&#8217;s data objects</p>
</div></blockquote>
<p><strong>params</strong> : dict</p>
<blockquote class="last">
<div><p>Parameters or metadata for dataset</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.loadImages">
<tt class="descname">loadImages</tt><big>(</big><em>dataPath</em>, <em>dims=None</em>, <em>dtype=None</em>, <em>inputFormat='stack'</em>, <em>ext=None</em>, <em>startIdx=None</em>, <em>stopIdx=None</em>, <em>recursive=False</em>, <em>nplanes=None</em>, <em>npartitions=None</em>, <em>renumber=False</em>, <em>confFilename='conf.json'</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.loadImages" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads an Images object from data stored as a binary image stack, tif, or png files.</p>
<p>Supports single files or multiple files, stored on a local file system, a networked file sytem
(mounted and available on all nodes), or Amazon S3. HDFS is not currently supported for image file data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataPath: string</strong></p>
<blockquote>
<div><p>Path to data files or directory, as either a local filesystem path or a URI.
May include a single &#8216;*&#8217; wildcard in the filename. Examples of valid dataPaths include
&#8216;local/directory/<a href="#id3"><span class="problematic" id="id4">*</span></a>.stack&#8221;, &#8220;s3n:///my-s3-bucket/data/&#8221;, or &#8220;file:///mnt/another/directory/&#8221;.</p>
</div></blockquote>
<p><strong>dims: tuple of positive int, optional (required if inputFormat is &#8216;stack&#8217;)</strong></p>
<blockquote>
<div><p>Image dimensions. Binary stack data will be interpreted as a multidimensional array
with the given dimensions, and should be stored in row-major order (Fortran or Matlab convention),
where the first dimension changes most rapidly. For &#8216;png&#8217; or &#8216;tif&#8217; data dimensions
will be read from the image file headers.</p>
</div></blockquote>
<p><strong>inputFormat: str, optional, default = &#8216;stack&#8217;</strong></p>
<blockquote>
<div><p>Expected format of the input data: &#8216;stack&#8217;, &#8216;png&#8217;, or &#8216;tif&#8217;. &#8216;stack&#8217; indicates flat binary stacks.
&#8216;png&#8217; or &#8216;tif&#8217; indicate image format. Page of a multipage tif file will be extend along
the third dimension. Separate files interpreted as distinct records, with ordering
given by lexicographic sorting of file names.</p>
</div></blockquote>
<p><strong>ext: string, optional, default = None</strong></p>
<blockquote>
<div><p>File extension, default will be &#8220;bin&#8221; if inputFormat==&#8221;stack&#8221;, &#8220;tif&#8221; for inputFormat==&#8217;tif&#8217;,
and &#8216;png&#8217; for inputFormat==&#8221;png&#8221;.</p>
</div></blockquote>
<p><strong>dtype: string or numpy dtype, optional, default = &#8216;int16&#8217;</strong></p>
<blockquote>
<div><p>Data type of the image files to be loaded, specified as a numpy &#8220;dtype&#8221; string.
Ignored for &#8216;tif&#8217; or &#8216;png&#8217; (data will be inferred from image formats).</p>
</div></blockquote>
<p><strong>startIdx: nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>Convenience parameters to read only a subset of input files. Uses python slice conventions
(zero-based indexing with exclusive final position). These parameters give the starting
and final index after lexicographic sorting.</p>
</div></blockquote>
<p><strong>stopIdx: nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>See startIdx.</p>
</div></blockquote>
<p><strong>recursive: boolean, optional, default = False</strong></p>
<blockquote>
<div><p>If true, will recursively descend directories rooted at dataPath, loading all files
in the tree with an appropriate extension.</p>
</div></blockquote>
<p><strong>nplanes: positive integer, optional, default = None</strong></p>
<blockquote>
<div><p>Subdivide individual image files. Every <cite>nplanes</cite> from each file will be considered a new record.
With nplanes=None (the default), a single file will be considered as representing a single record.
If the number of records per file is not the same across all files, then <cite>renumber</cite> should be set
to True to ensure consistent keys.</p>
</div></blockquote>
<p><strong>npartitions: positive int, optional, default = None</strong></p>
<blockquote>
<div><p>Specify number of partitions for the RDD, if unspecified will use 1 partition per image.</p>
</div></blockquote>
<p><strong>renumber: boolean, optional, default = False</strong></p>
<blockquote>
<div><p>Recalculate keys for records after images are loading. Only necessary if different files contain
different number of records (e.g. due to specifying nplanes). See Images.renumber().</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">data: thunder.rdds.Images</p>
<blockquote class="last">
<div><p>An Images object, wrapping an RDD of with (int) : (numpy array) pairs</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.loadImagesAsSeries">
<tt class="descname">loadImagesAsSeries</tt><big>(</big><em>dataPath</em>, <em>dims=None</em>, <em>inputFormat='stack'</em>, <em>ext=None</em>, <em>dtype='int16'</em>, <em>blockSize='150M'</em>, <em>blockSizeUnits='pixels'</em>, <em>startIdx=None</em>, <em>stopIdx=None</em>, <em>shuffle=True</em>, <em>recursive=False</em>, <em>nplanes=None</em>, <em>npartitions=None</em>, <em>renumber=False</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.loadImagesAsSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Load Images data as Series data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataPath: string</strong></p>
<blockquote>
<div><p>Path to data files or directory, as either a local filesystem path or a URI.
May include a single &#8216;*&#8217; wildcard in the filename. Examples of valid dataPaths include
&#8216;local/directory/<a href="#id5"><span class="problematic" id="id6">*</span></a>.stack&#8221;, &#8220;s3n:///my-s3-bucket/data/&#8221;, or &#8220;file:///mnt/another/directory/&#8221;.</p>
</div></blockquote>
<p><strong>dims: tuple of positive int, optional (required if inputFormat is &#8216;stack&#8217;)</strong></p>
<blockquote>
<div><p>Image dimensions. Binary stack data will be interpreted as a multidimensional array
with the given dimensions, and should be stored in row-major order (Fortran or Matlab convention),
where the first dimension changes most rapidly. For &#8216;png&#8217; or &#8216;tif&#8217; data dimensions
will be read from the image file headers.</p>
</div></blockquote>
<p><strong>inputFormat: str, optional, default = &#8216;stack&#8217;</strong></p>
<blockquote>
<div><p>Expected format of the input data: &#8216;stack&#8217;, &#8216;png&#8217;, or &#8216;tif&#8217;. &#8216;stack&#8217; indicates flat binary stacks.
&#8216;png&#8217; or &#8216;tif&#8217; indicate image formats. Page of a multipage tif file will be extend along
the third dimension. Separate files interpreted as distinct records, with ordering
given by lexicographic sorting of file names.</p>
</div></blockquote>
<p><strong>ext: string, optional, default = None</strong></p>
<blockquote>
<div><p>File extension, default will be &#8220;bin&#8221; if inputFormat==&#8221;stack&#8221;, &#8220;tif&#8221; for inputFormat==&#8217;tif&#8217;,
and &#8216;png&#8217; for inputFormat==&#8221;png&#8221;.</p>
</div></blockquote>
<p><strong>dtype: string or numpy dtype. optional, default &#8216;int16&#8217;</strong></p>
<blockquote>
<div><p>Data type of the image files to be loaded, specified as a numpy &#8220;dtype&#8221; string.
Ignored for &#8216;tif&#8217; or &#8216;png&#8217; (data will be inferred from image formats).</p>
</div></blockquote>
<p><strong>blockSize: string or positive int, optional, default &#8220;150M&#8221;</strong></p>
<blockquote>
<div><p>Requested size of blocks (e.g &#8220;64M&#8221;, &#8220;512k&#8221;, &#8220;2G&#8221;). If shuffle=True, can also be a
tuple of int specifying the number of pixels or splits per dimension. Indirectly
controls the number of Spark partitions, with one partition per block.</p>
</div></blockquote>
<p><strong>blockSizeUnits: string, either &#8220;pixels&#8221; or &#8220;splits&#8221;, default &#8220;pixels&#8221;</strong></p>
<blockquote>
<div><p>Units for interpreting a tuple passed as blockSize when shuffle=True.</p>
</div></blockquote>
<p><strong>startIdx: nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>Convenience parameters to read only a subset of input files. Uses python slice conventions
(zero-based indexing with exclusive final position). These parameters give the starting
and final index after lexicographic sorting.</p>
</div></blockquote>
<p><strong>stopIdx: nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>See startIdx.</p>
</div></blockquote>
<p><strong>shuffle: boolean, optional, default = True</strong></p>
<blockquote>
<div><p>Controls whether the conversion from Images to Series formats will use of a Spark shuffle-based method.</p>
</div></blockquote>
<p><strong>recursive: boolean, optional, default = False</strong></p>
<blockquote>
<div><p>If true, will recursively descend directories rooted at dataPath, loading all files
in the tree with an appropriate extension.</p>
</div></blockquote>
<p><strong>nplanes: positive integer, optional, default = None</strong></p>
<blockquote>
<div><p>Subdivide individual image files. Every <cite>nplanes</cite> from each file will be considered a new record.
With nplanes=None (the default), a single file will be considered as representing a single record.
If the number of records per file is not the same across all files, then <cite>renumber</cite> should be set
to True to ensure consistent keys.</p>
</div></blockquote>
<p><strong>npartitions: positive int, optional, default = None</strong></p>
<blockquote>
<div><p>Specify number of partitions for the RDD, if unspecified will use 1 partition per image.</p>
</div></blockquote>
<p><strong>renumber: boolean, optional, default = False</strong></p>
<blockquote>
<div><p>Recalculate keys for records after images are loading. Only necessary if different files contain
different number of records (e.g. due to specifying nplanes). See Images.renumber().</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">data: thunder.rdds.Series</p>
<blockquote class="last">
<div><p>A Series object, wrapping an RDD, with (n-tuples of ints) : (numpy array) pairs.
Keys will be n-tuples of int, with n given by dimensionality of the images, and correspond
to indexes into the image arrays. Value will have length equal to the number of image files.
With each image contributing one point to this value array, with ordering given by
the lexicographic ordering of image file names.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.loadImagesOCP">
<tt class="descname">loadImagesOCP</tt><big>(</big><em>bucketName</em>, <em>resolution</em>, <em>server='ocp.me'</em>, <em>startIdx=None</em>, <em>stopIdx=None</em>, <em>minBound=None</em>, <em>maxBound=None</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.loadImagesOCP" title="Permalink to this definition">¶</a></dt>
<dd><p>Load Images from OCP (Open Connectome Project).</p>
<p>The OCP is a web service for access to EM brain images and other neural image data.
The web-service can be accessed at <a class="reference external" href="http://www.openconnectomeproject.org/">http://www.openconnectomeproject.org/</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>bucketName: string</strong></p>
<blockquote>
<div><p>Token name for the project in OCP. This name should exist on the server from which data is loaded.</p>
</div></blockquote>
<p><strong>resolution: nonnegative int</strong></p>
<blockquote>
<div><p>Resolution of the data in OCP</p>
</div></blockquote>
<p><strong>server: string, optional, default = &#8216;ocp.me&#8217;</strong></p>
<blockquote>
<div><p>Name of the OCP server with the specified token.</p>
</div></blockquote>
<p><strong>startIdx: nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>Convenience parameters to read only a subset of input files. Uses python slice conventions
(zero-based indexing with exclusive final position).</p>
</div></blockquote>
<p><strong>stopIdx: nonnegative int, optional</strong></p>
<blockquote>
<div><p>See startIdx.</p>
</div></blockquote>
<p><strong>minBound, maxBound: tuple of nonnegative int, optional, default = None</strong></p>
<blockquote>
<div><p>X,Y,Z bounds of the data to fetch from OCP. minBound contains the (xMin,yMin,zMin) while
maxBound contains (xMax,yMax,zMax).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">data: thunder.rdds.Images</p>
<blockquote class="last">
<div><p>An Images object, wrapping an RDD of with (int) : (numpy array) pairs</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.loadParams">
<tt class="descname">loadParams</tt><big>(</big><em>path</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.loadParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a file with parameters from a local file system or S3.</p>
<p>Assumes file is JSON with basic types (strings, integers, doubles, lists),
in either a single dict or list of dict-likes, and each dict has at least
a &#8220;name&#8221; field and a &#8220;value&#8221; field.</p>
<p>Useful for loading generic meta data, parameters, covariates, etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong> : str</p>
<blockquote>
<div><p>Path to file, can be on a local file system or an S3 bucket</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A dict or list with the parameters</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.loadSeries">
<tt class="descname">loadSeries</tt><big>(</big><em>dataPath</em>, <em>nkeys=None</em>, <em>nvalues=None</em>, <em>inputFormat='binary'</em>, <em>minPartitions=None</em>, <em>confFilename='conf.json'</em>, <em>keyType=None</em>, <em>valueType=None</em>, <em>keyPath=None</em>, <em>varName=None</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.loadSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a Series object from data stored as binary, text, npy, or mat.</p>
<p>For binary and text, supports single files or multiple files stored on a local file system,
a networked file system (mounted and available on all cluster nodes), Amazon S3, or HDFS.
For local formats (npy and mat) only local file systems currently supported.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataPath: string</strong></p>
<blockquote>
<div><p>Path to data files or directory, as either a local filesystem path or a URI.
May include a single &#8216;*&#8217; wildcard in the filename. Examples of valid dataPaths include
&#8216;local/directory/<a href="#id7"><span class="problematic" id="id8">*</span></a>.stack&#8221;, &#8220;s3n:///my-s3-bucket/data/&#8221;, or &#8220;file:///mnt/another/directory/&#8221;.</p>
</div></blockquote>
<p><strong>nkeys: int, optional (required if `inputFormat` is &#8216;text&#8217;), default = None</strong></p>
<blockquote>
<div><p>Number of keys per record (e.g. 3 for (x, y, z) coordinate keys). Must be specified for
text data; can be specified here or in a configuration file for binary data.</p>
</div></blockquote>
<p><strong>nvalues: int, optional (required if `inputFormat` is &#8216;text&#8217;)</strong></p>
<blockquote>
<div><p>Number of values per record. Must be specified here or in a configuration file for binary data.</p>
</div></blockquote>
<p><strong>inputFormat: {&#8216;text&#8217;, &#8216;binary&#8217;, &#8216;npy&#8217;, &#8216;mat&#8217;}. optional, default = &#8216;binary&#8217;</strong></p>
<blockquote>
<div><p>inputFormat of data to be read.</p>
</div></blockquote>
<p><strong>minPartitions: int, optional, default = SparkContext.minParallelism</strong></p>
<blockquote>
<div><p>Minimum number of Spark partitions to use, only for text.</p>
</div></blockquote>
<p><strong>confFilename: string, optional, default &#8216;conf.json&#8217;</strong></p>
<blockquote>
<div><p>Path to JSON file with configuration options including &#8216;nkeys&#8217;, &#8216;nvalues&#8217;,
&#8216;keyType&#8217;, and &#8216;valueType&#8217;. If a file is not found at the given path, then the base
directory in &#8216;dataPath&#8217; will be checked. Parameters will override the conf file.</p>
</div></blockquote>
<p><strong>keyType: string or numpy dtype, optional, default = None</strong></p>
<blockquote>
<div><p>Numerical type of keys, will override conf file.</p>
</div></blockquote>
<p><strong>valueType: string or numpy dtype, optional, default = None</strong></p>
<blockquote>
<div><p>Numerical type of values, will override conf file.</p>
</div></blockquote>
<p><strong>keyPath: string, optional, default = None</strong></p>
<blockquote>
<div><p>Path to file with keys when loading from npy or mat.</p>
</div></blockquote>
<p><strong>varName</strong> : str, optional, default = None</p>
<blockquote>
<div><p>Variable name to load (for MAT files only)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">data: thunder.rdds.Series</p>
<blockquote class="last">
<div><p>A Series object, wrapping an RDD, with (n-tuples of ints) : (numpy array) pairs</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.makeExample">
<tt class="descname">makeExample</tt><big>(</big><em>dataset</em>, <em>**opts</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.makeExample" title="Permalink to this definition">¶</a></dt>
<dd><p>Make an example data set for testing analyses.</p>
<p>Options include &#8216;pca&#8217;, &#8216;kmeans&#8217;, and &#8216;ica&#8217;.
See thunder.utils.datasets for detailed options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dataset</strong> : str</p>
<blockquote>
<div><p>Which dataset to generate</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>data</strong> : RDD of (tuple, array) pairs</p>
<blockquote class="last">
<div><p>Generated dataset</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="thunder.ThunderContext.setAWSCredentials">
<tt class="descname">setAWSCredentials</tt><big>(</big><em>awsAccessKeyId</em>, <em>awsSecretAccessKey</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.setAWSCredentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually set AWS access credentials to be used by Thunder.</p>
<p>Provided for hosted cloud environments without filesystem access.
If launching a cluster using the thunder-ec2 script, credentials will be configured
automatically (inside core-site.xml and ~/.boto), so this method should not need to be called.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>awsAccessKeyId</strong> : string</p>
<blockquote>
<div><p>AWS public key, usually starts with &#8220;AKIA&#8221;</p>
</div></blockquote>
<p><strong>awsSecretAccessKey</strong> : string</p>
<blockquote class="last">
<div><p>AWS private key</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="thunder.ThunderContext.start">
<em class="property">classmethod </em><tt class="descname">start</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#thunder.ThunderContext.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts a ThunderContext using the same arguments as SparkContext</p>
</dd></dl>

</dd></dl>

</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/generated/thunder.ThunderContext.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>